/*To test the regulation element to produce negative noise. Using both ositive and negative noise. 
The oscillations ade decoupled even though there is no variability in the expression times
To test:
 - Try different parameters and check that the fraction over the 0.5 threshold 
 - Add variability in the times too
*/


include gro3

//---params
t_act := 10.0;
t_act_var := 0.0;
t_deg := 10.0;
t_deg_var := 0.0;

actiMeanOn := 0.7; //expected ~0.97725 of the cells the > 0.5 theshold
actiStddevOn := 0.1;
actiMeanOff := 0.4; //expected ~0.84134 of the cells the < 0.5 theshold
actiStddevOff := 0.1;

global_params([ seed := 123242, show_plots := true ]);


//----------------------BIOCIRCUITS---------------------------
//---cells
cell_type([ name := "cell_A", plasmids := {"p_A"} ]);


//---gene expression
molecule([ name := "mol_A", times := { -t_deg, t_act }, times_var := { t_deg_var, t_act_var } ]);

//---
bgate([ name := "ga_notMolA", input := {"-mol_A"} ]);
regulation([ name := "reg_notA"
	, gate := "ga_notMolA"
	, acti_on := { actiMeanOn, actiStddevOn }
	, acti_off := { actiMeanOff, actiStddevOff }
]);

//---
//operon([ name := "op_A", gate := "ga_notMolA", output := {"mol_A"} ]);
operon([ name := "op_A", regulation := "reg_notA", output := {"mol_A"} ]);
plasmid([ name := "p_A", operons := {"op_A"} ]);


//------------ WORLD CONTROL -----------------------
//---placers
cell_placer([ name := "cp_A", cell_types := {"cell_A"}, amount := 100.0, coords := [ x := 0.0, y := 0.0, r := 100.0 ] ]);


//------------ VISUALS -----------------------
cell_colour([ name := "ccol_green", gate := "mol_A", rgb := _green ]);

plot([ name := "plot_A", fields := {"mol_A"}, stats := "avg" ]);